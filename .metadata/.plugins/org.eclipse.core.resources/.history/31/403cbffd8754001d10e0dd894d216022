package service;

import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;

import DB.DBControl;
import model.loginmodel;

public class loginservice {
	
	private PreparedStatement pstmt = null;
	private ResultSet rs = null;  
	
	public int getlogin(loginmodel lgm)
	{
		//DB 연동해서 얻어옴 
		DBControl db=new DBControl();
		db.dbOpen();
		
		String sql = "SELECT password FROM user WHERE id = ?";
		
		try
		{
			pstmt=db.getConncetion().prepareStatement(sql);
			
			pstmt.setString(1, lgm.getId());
	            
	        rs = pstmt.executeQuery();
	        
	            if (rs.next()) 
	            {
	               if (rs.getString(1).equals(lgm.getpwd()))
	            	   return 1;		//로그인 성공
	               else
	            	   return 0;	//비밀번호 불일치
	            } 
	            
	            return -1;	//아이디가 없음
        }
		catch(SQLException e)
		{
			e.printStackTrace();
			return -2;	//오류
		} 
		finally 
		{
			 try 
             {
                 rs.close();
             } 
             catch (SQLException e) 
             {
                 e.printStackTrace();
             }
			 try 
             {
             	pstmt.close();
             }
             catch (SQLException e) 
             {
                 e.printStackTrace();
             }
            db.Close();
		} 
		
		
	
	}
}
